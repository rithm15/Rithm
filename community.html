<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Community Chat</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:'Poppins',sans-serif;}
body{display:flex;height:100vh;background:linear-gradient(135deg,#f0f4f8,#d0e4f7,#fef9f2);color:#111;overflow:hidden;}
.sidebar{width:28%;background:rgba(255,255,255,0.9);backdrop-filter:blur(12px);padding:1rem;display:flex;flex-direction:column;gap:0.6rem;overflow-y:auto;}
.sidebar h2{color:#3f51b5;font-size:1.5rem;margin-bottom:1rem;}
.chat-card{padding:1rem;border-radius:16px;cursor:pointer;color:#111;transition:.3s;background:rgba(255,255,255,0.85);box-shadow:0 4px 12px rgba(0,0,0,0.05);}
.chat-card:hover{transform:scale(1.05);box-shadow:0 6px 20px rgba(0,0,0,0.1);}
.chat-card.active{background:#3f51b5;color:#fff;}
.chat-area{flex:1;display:flex;flex-direction:column;background:rgba(255,255,255,0.75);backdrop-filter:blur(12px);padding:0.5rem;gap:0.5rem;overflow:hidden;}
.chat-header{padding:1rem;font-size:1.2rem;color:#3f51b5;display:flex;align-items:center;gap:8px;flex-shrink:0;}
.typing{font-size:.9rem;color:#555;animation:blink 1s infinite;}
@keyframes blink{0%,100%{opacity:1;}50%{opacity:0.5;}}
.messages{flex:1;padding:1rem;overflow-y:auto;display:flex;flex-direction:column;gap:10px;}
.msg{display:inline-block;padding:10px 14px;border-radius:18px;max-width:70%;word-wrap:break-word;position:relative;animation:bounceIn 0.4s ease;}
@keyframes bounceIn{0%{transform:scale(0.8);opacity:0;}100%{transform:scale(1);opacity:1;}}
.msg.self{background:linear-gradient(135deg,#c5cae9,#7986cb);color:#fff;margin-left:auto;border-bottom-right-radius:4px;box-shadow:0 0 12px rgba(63,81,181,0.5);}
.msg.other{background:rgba(255,255,255,0.85);color:#111;margin-right:auto;border-bottom-left-radius:4px;box-shadow:0 0 8px rgba(0,0,0,0.05);}
.msg img,.msg video{max-width:100%;border-radius:12px;margin-top:6px;}
.msg a{color:#3f51b5;text-decoration:none;word-break:break-word;}
.delete-btn{position:absolute;top:-8px;right:-8px;background:#f44336;border:none;border-radius:50%;width:20px;height:20px;cursor:pointer;color:#fff;font-size:12px;line-height:18px;}
.chat-input{display:flex;padding:12px;gap:8px;align-items:center;flex-shrink:0;flex-wrap:wrap;}
.chat-input input[type="text"]{flex:1;padding:10px;border-radius:20px;border:none;background:rgba(255,255,255,0.85);color:#111;outline:none;}
.chat-input input[type="file"]{display:none;}
.chat-input button,.chat-input label{padding:10px 16px;border-radius:20px;border:none;background:#3f51b5;color:#fff;cursor:pointer;font-weight:600;transition:.2s;}
.chat-input button:hover,.chat-input label:hover{box-shadow:0 0 12px #3f51b5aa;}
#preview{display:flex;gap:8px;margin-top:6px;flex-wrap:wrap;border-top:1px solid #ccc;padding-top:6px;}
#preview img,#preview video{max-height:100px;border-radius:12px;}
#preview a{padding:6px 10px;background:#e3f2fd;border-radius:8px;text-decoration:none;color:#3f51b5;font-weight:500;}
@media(max-width:768px){body{flex-direction:column;}.sidebar{width:100%;flex-direction:row;overflow-x:auto;gap:0.5rem;padding:0.5rem;}.chat-card{flex:0 0 auto;min-width:120px;text-align:center;}.chat-area{flex:1;width:100%;padding:0;}.messages{padding:0.5rem;}.chat-input{flex-direction:column;gap:4px;}}
</style>
</head>
<body>

<div class="sidebar">
  <h2>ðŸ’¬ Chats</h2>
  <div class="chat-card active">Your Room</div>
</div>

<div class="chat-area">
  <div class="chat-header">ðŸ’¬ Your Room <span class="typing">| Write, Share, Chill âœ¨</span></div>
  <div id="preview"></div>
  <div class="messages" id="messages"></div>

  <div class="chat-input">
    <input type="text" id="msgInput" placeholder="Type a message ðŸ˜ƒðŸ”¥ðŸ“š...">
    <input type="file" id="fileInput" accept="image/*,video/*,.pdf,.txt,.doc,.docx" multiple>
    <label for="fileInput">ðŸ“Ž Attach</label>
    <button type="button" id="sendBtn">ðŸš€ Send</button>
  </div>
</div>

<script>
const messagesDiv = document.getElementById("messages");
const msgInput = document.getElementById("msgInput");
const fileInput = document.getElementById("fileInput");
const previewDiv = document.getElementById("preview");
const sendBtn = document.getElementById("sendBtn");

let messages = JSON.parse(localStorage.getItem("messages")) || [];
renderMessages();

// Preview files
fileInput.addEventListener('change', () => {
    previewDiv.innerHTML = '';
    Array.from(fileInput.files).forEach(file => {
        const reader = new FileReader();
        reader.onload = e => {
            if(file.type.startsWith('image/')){
                const img = document.createElement('img'); img.src = e.target.result;
                previewDiv.appendChild(img);
            } else if(file.type.startsWith('video/')){
                const vid = document.createElement('video'); vid.src = e.target.result; vid.controls = true;
                previewDiv.appendChild(vid);
            } else {
                const link = document.createElement('a'); link.textContent = 'ðŸ“‚ '+file.name; link.href = e.target.result; link.download = file.name;
                previewDiv.appendChild(link);
            }
        }
        reader.readAsDataURL(file);
    });
});

// Send messages
sendBtn.addEventListener('click', () => {
    const text = msgInput.value.trim();
    const files = Array.from(fileInput.files);

    if(!text && files.length===0) return;

    files.forEach(file => {
        const reader = new FileReader();
        reader.onload = e => {
            const type = file.type.startsWith('image/') ? 'image' : file.type.startsWith('video/') ? 'video' : 'file';
            messages.push({type, content:e.target.result, name:file.name, self:true});
            saveAndRender();
        }
        reader.readAsDataURL(file);
    });

    if(text){
        messages.push({type:'text', content:text, self:true});
        saveAndRender();
    }

    msgInput.value = '';
    fileInput.value = '';
    previewDiv.innerHTML = '';
});

// Render messages
function renderMessages(){
    messagesDiv.innerHTML = '';
    messages.forEach((msg,index) => {
        const div = document.createElement('div');
        div.className = 'msg '+(msg.self?'self':'other');
        if(msg.type==='text') div.textContent = msg.content;
        else if(msg.type==='image') div.innerHTML=`<img src="${msg.content}" alt="Image"><div>${msg.name}</div>`;
        else if(msg.type==='video') div.innerHTML=`<video src="${msg.content}" controls></video><div>${msg.name}</div>`;
        else div.innerHTML=`<a href="${msg.content}" download="${msg.name}">ðŸ“‚ ${msg.name}</a>`;

        const delBtn = document.createElement('button');
        delBtn.className = 'delete-btn'; delBtn.textContent='Ã—';
        delBtn.onclick = ()=>{messages.splice(index,1); saveAndRender();}
        div.appendChild(delBtn);

        messagesDiv.appendChild(div);
    });
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Save to localStorage
function saveAndRender(){
    localStorage.setItem('messages', JSON.stringify(messages));
    renderMessages();
}

// Enter key sends text only
msgInput.addEventListener('keypress', e=>{
    if(e.key==='Enter'){ e.preventDefault(); if(msgInput.value.trim()) sendBtn.click();}
});
</script>
</body>
</html>
